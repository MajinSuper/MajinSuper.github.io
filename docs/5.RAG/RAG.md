---
title: RAG
tags:
  - RAG
createTime: 2025-12-21 10:44:31
permalink: /article/introduce_RAG/
---

### RAG基本流程

- ==离线==：切分、索引
- ==在线==：召回、重排、生成

#### （离线）切分
- 按句子分：太细太碎
- 按段落分：不均衡，可能会很长，可能会很多
- 按字数分：语义不连贯

#### （离线）索引
- 将每个chunk进行向量化表达，放入向量库中以备后续查询

::: tip 常见面试题
:::

::: details 1. 如何向量化？模型怎么选的？有没有自己训练过？
:::

::: details 2. 向量库有了解吗？向量库是怎么选择的？
:::

#### （在线）召回
纯向量的泛化性好，但对精确符号、专属名词不敏感；
文本召回能解决精准匹配、且召回可控，稳定性好；
两者互补

- 向量召回：
    - 用户query进行emb后，跟库中的每个索引向量（矩阵运算） 计算相似度；
    - 计算相似度的方法：余弦、欧式距离、点积
    - **核心**：“能解决用户==想表达什么==”
    - **优势**：==泛化性==，近似语义理解（谷歌/必应/搜索引擎）、跨语言理解（谷歌浏览器/chrome）、容错性（拼写错误、模糊表述）
    - **不足**：缩写词和短语（忍3、“楠”得一见）、搜索具体专有名词（歌名+歌名的remix）和人名可能会飘逸（马丁->马丁内斯）
- 文本&图谱召回（倒排）：
    - 提取领域实体 -> 实体文本多路召回：原词，n-gram，拼音，拼音首字母
    - 实体 -> 文本：实体属性，周围一跳的信息描述（模板）
    - 文本检索引擎：ElasticSearch

